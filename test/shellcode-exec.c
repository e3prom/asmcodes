/* shellcode-exec.c
 *
 * This little C program allow you to create a simple ELF executable to execute
 * your shellcode. Please follow compile instructions below:
 * gcc -fno-stack-protector -z execstack shellcode-exec.c -o shellcode:
 * ./shellcode
 *
 */
#include <stdio.h>
#include <string.h>

/* Replace below character array with your shellcode */
unsigned char scode[] =
  "\x48\x31\xc0\x48\xff\xc0\x48\x89"
  "\xc7\x68\x2e\x20\x20\x0a\x48\xbb"
  "\x6f\x64\x61\x79\x3f\x22\x2e\x2e"
  "\x53\x68\x65\x64\x20\x74\x48\xbb"
  "\x20\x79\x6f\x75\x20\x6d\x6f\x6f"
  "\x53\x48\xbb\x2e\x2e\x2e\x22\x48"
  "\x61\x76\x65\x53\x68\x7e\x20\x20"
  "\x0a\x48\xbb\x20\x20\x7e\x7e\x20"
  "\x20\x20\x7e\x53\x68\x20\x20\x20"
  "\x20\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x20\x53\x68\x5c\x20\x20"
  "\x0a\x48\xbb\x20\x20\x2f\x5c\x2d"
  "\x2d\x2d\x2f\x53\x68\x20\x20\x20"
  "\x2a\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x20\x53\x68\x7c\x20\x20"
  "\x0a\x48\xbb\x2f\x20\x7c\x20\x20"
  "\x20\x20\x7c\x53\x68\x20\x20\x20"
  "\x20\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x20\x53\x68\x5c\x2f\x20"
  "\x0a\x48\xbb\x20\x2f\x2d\x2d\x2d"
  "\x2d\x2d\x2d\x53\x68\x20\x20\x20"
  "\x20\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x20\x53\x68\x6f\x6f\x29"
  "\x0a\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x28\x53\x68\x20\x20\x20"
  "\x20\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x20\x53\x68\x5f\x5f\x29"
  "\x0a\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x28\x53\x68\x20\x20\x20"
  "\x20\x48\xbb\x20\x20\x20\x20\x20"
  "\x20\x20\x20\x53\x48\x89\xe6\x48"
  "\x31\xd2\x48\x81\xc2\xe6\x00\x00"
  "\x00\x0f\x05\x48\x31\xc0\x48\x83"
  "\xc0\x3c\x48\x31\xff\x0f\x05";

int main()
{
  printf("Shellcode length is: %d", (int)strlen(scode));
  int (*ret)() = (int(*)())scode;
  ret();
}
